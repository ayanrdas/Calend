<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Interactive 2025 Calendar</title>
  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet"/>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
    #calendar { max-width: 900px; margin: 0 auto; }
    /* Modal overlay */
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; }
    .modal-content { background: #fff; padding: 20px; border-radius: 4px; width: 300px; }
    .modal-content label { display: block; margin-top: 10px; }
    .modal-content textarea, .modal-content input[type="color"] { width: 100%; box-sizing: border-box; }
    .modal-content button { margin-top: 10px; }
  </style>
</head>
<body>
  <div id="calendar"></div>

  <!-- Modal for task entry -->
  <div id="taskModal" class="modal">
    <div class="modal-content">
      <h3 id="modalDate">YYYY-MM-DD</h3>
      <label>Tasks:</label>
      <textarea id="taskInput" rows="4" placeholder="Enter tasksâ€¦"></textarea>
      <label>Cell Color:</label>
      <input type="color" id="colorInput" value="#ffff00"/>
      <div style="text-align: right;">
        <button id="saveBtn">Save</button>
        <button id="cancelBtn">Cancel</button>
      </div>
    </div>
  </div>

  <!-- FullCalendar JS (global build) -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const STORAGE_KEY = 'calendar2025';
      const stored = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
      let selectedDate = null;

      // Modal elements
      const modal = document.getElementById('taskModal');
      const modalDateEl = document.getElementById('modalDate');
      const taskInput   = document.getElementById('taskInput');
      const colorInput  = document.getElementById('colorInput');
      const saveBtn     = document.getElementById('saveBtn');
      const cancelBtn   = document.getElementById('cancelBtn');

      let calendar;
      function renderCalendar() {
        if (calendar) calendar.destroy();
        calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
          initialView: 'dayGridMonth',
          initialDate: '2025-06-01',
          validRange: { start: '2025-01-01', end: '2025-12-31' },
          headerToolbar: { left: 'prev,next', center: 'title', right: '' },
          dateClick: info => {
            selectedDate = info.dateStr;
            modalDateEl.textContent = selectedDate;
            const entry = stored[selectedDate] || { tasks: '', color: '#ffffff' };
            taskInput.value  = entry.tasks;
            colorInput.value = entry.color;
            modal.style.display = 'flex';
          },
          dayCellDidMount: info => {
            const d = info.date.toISOString().slice(0,10);
            if (stored[d]) {
              info.el.style.backgroundColor = stored[d].color;
              if (stored[d].tasks) {
                const div = document.createElement('div');
                div.textContent = stored[d].tasks;
                div.style.fontSize = '0.75em';
                div.style.marginTop = '4px';
                div.classList.add('task-text');
                info.el.appendChild(div);
              }
            }
          }
        });
        calendar.render();
      }

      renderCalendar();

      // Save to localStorage and refresh calendar
      saveBtn.addEventListener('click', () => {
        stored[selectedDate] = {
          tasks: taskInput.value.trim(),
          color: colorInput.value
        };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(stored));
        modal.style.display = 'none';
        renderCalendar();
      });

      cancelBtn.addEventListener('click', () => {
        modal.style.display = 'none';
      });
    });
  </script>
</body>
</html>
